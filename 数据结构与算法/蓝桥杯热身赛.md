# G

## Description:

陶陶家的院子里有一棵苹果树，每到秋天树上就会结出10个苹果。苹果成熟的时候，陶陶就会跑去摘苹果。陶陶有个30厘米高的板凳，当她不能直接用手摘到苹果的时候，就会踩到板凳上再试试。

现在已知10个苹果到地面的高度，以及陶陶把手伸直的时候能够达到的最大高度，请帮陶陶算一下她能够摘到的苹果的数目。假设她碰到苹果，苹果就会掉下来。

## Input:

输入包括两行数据。第一行包含10个100到200之间（包括100和200）的整数（以厘米为单位）分别表示10个苹果到地面的高度，两个相邻的整数之间用一个空格隔开。第二行只包括一个100到120之间（包含100和120）的整数（以厘米为单位），表示陶陶把手伸直的时候能够达到的最大高度。

## Output:

输出包括一行，这一行只包含一个整数，表示陶陶能够摘到的苹果的数目。

## Sample Input:

```
100 200 150 140 129 134 167 198 200 111
110
```

Copy

## Sample Output:

```
5
```

Copy

## Note:

每个测试点1s

```Java
import java.util.List;
import java.util.ArrayList;
import java.util.Scanner;

public class Main {
    public static void main(String[] args) {
        Scanner s = new Scanner(System.in);
        List<Integer> apples = new ArrayList<>();
        int i = 0;
        while (i++ < 10) {
            apples.add(s.nextInt());
        }
        int taotao = s.nextInt() + 30;
        int count = 0;
        for (int apple : apples) {
            if (apple <= taotao) count++;
        }
        System.out.println(count);
    }
}
```



# A 税收与补贴问题

## Description:

每样商品的价格越低，其销量就会相应增大。现已知某种商品的成本及其在若干价位上的销量（产品不会低于成本销售），并假设相邻价位间销量的变化是线性的且在价格高于给定的最高价位后，销量以某固定数值递减。（我们假设价格及销售量都是整数）
对于某些特殊商品，不可能完全由市场去调节其价格。这时候就需要政府以税收或补贴的方式来控制。（所谓税收或补贴就是对于每个产品收取或给予生产厂家固定金额的货币）问题求解：
你是某家咨询公司的项目经理，现在你已经知道政府对某种商品的预期价格，以及在各种价位上的销售情况。要求你确定政府对此商品是应收税还是补贴的最少金额（也为整数），才能使商家在这样一种政府预期的价格上，获取相对其他价位上的最大总利润。

总利润=单位商品利润*销量
单位商品利润=单位商品价格-单位商品成本（-税金 or +补贴）

## Input:

输入的第一行为政府对某种商品的预期价，第二行有两个整数，第一个整数为商品成本，第二个整数为以成本价销售时的销售量，以下若干行每行都有两个整数，第一个为某价位时的单价，第二个为此时的销量，以一行-1，-1表示所有已知价位及对应的销量输入完毕，输入的最后一行为一个单独的整数表示在已知的最高单价外每升高一块钱将减少的销量。

## Output:

输出有两种情况：若在政府预期价上能得到最大总利润，则输出一个单独的整数，数的正负表示是补贴还是收税，数的大小表示补贴或收税的金额最小值。若有多解，取绝对值最小的输出。

如在政府预期价上不能得到最大总利润，则输出“NO SOLUTION”。

## Sample Input:

```
31
28 130
30 120
31 110
-1 -1
15
```

Copy

## Sample Output:

```
4
```

Copy

## Note:

1 second

```Java
import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;

public class MaxMin {
    public static void main(String[] args) {
        Scanner s = new Scanner(System.in);
        int maxLiRun = 0;
        int zuiZhongPrice = 0;
        int zhengFu;
        zhengFu = s.nextInt();
        int chengBen = s.nextInt();
        int chengX = s.nextInt();
        int s1 =s.nextInt();
        int s2 =s.nextInt();
        while (s1!= -1) {
            int LiRun = (s1 - chengBen) * s2;
            if (LiRun > maxLiRun) {
                maxLiRun = LiRun;
                zuiZhongPrice = s1;
            }
            s1 = s.nextInt();
            s2 = s.nextInt();
        }
        int dec = s.nextInt();
        if (zuiZhongPrice!=zhengFu) System.out.println("NO SOLUTION");
        else System.out.println(Math.abs(chengBen-zuiZhongPrice));
    }
}
```





# D Hanoi双塔问题

## Description:

给定A,B,C三根足够长的细柱，在A柱上放有2n个中间有孔的圆盘，共有n个不同的尺寸，每个尺寸都有两个相同的圆盘，注意这两个圆盘是不加区分的。现要将这些圆盘移到C柱上，在移动过程中可放在B柱上暂存。要求:

(1)每次只能移动一个圆盘；

(2) A、B、C三根细柱上的圆盘都要保持上小下大的顺序；

任务:设An为2n个圆盘完成上述任务所需的最少移动次数，对于输入的n，输出An。

## Input:

输入为一个正整数n，表示在A柱上放有2n个圆盘。

## Output:

输出文件hanoi.out仅一行，包含一个正整数，为完成上述任务所需的最少移动次数An。

## Sample Input:

```
1
```

Copy

## Sample Output:

```
2
```

Copy

## Sample Input:

```
2
```

Copy

## Sample Output:

```
6
```

Copy

## Note:

1s

对于50%的数据， 1<=n<=25

对于100% 数据， 1<=n<=200

提示:设法建立An与An-1的递推关系式。

```java
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.Scanner;

public class Main {
    public static void main(String[] args) throws IOException {
        Scanner s = new Scanner(System.in);
        int n = s.nextInt();
        int result = (int) ((Math.pow(2,n)-1)*2);
        FileOutputStream file = new FileOutputStream("hanoi.out");
        file.write(result);
    }
}
//竟然outOfMemoryError
```



```Java
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.Scanner;

public class Main {
    public static void main(String[] args) throws IOException {
        Scanner s = new Scanner(System.in);
        int n = s.nextInt();
        int pow=2;
        while (--n>0){
            pow*=2;
        }
        int result = (pow-1)*2;
        FileOutputStream file = new FileOutputStream("hanoi.out");
        file.write(result);
        file.close();
    }
}
```



# B 表达式的值

## Description:

对于 1 位二进制变量定义两种运算：
![img](https://cdn.vijos.org/fs/fbf65a280fccd756b8916d27dec182352e25a137)
运算的优先级是：

\1. 先计算括号内的，再计算括号外的。

\2. “×”运算优先于“⊕”运算，即计算表达式时，先计算×运算，再计算⊕运算。
例如：计算表达式A⊕B × C 时，先计算B × C，其结果再与A 做⊕运算。
现给定一个未完成的表达式，例如_+(***)，请你在横线处填入数字0 或者1，请问 有多少种填法可以使得表达式的值为0。

## Input:

共2 行。

第 1 行为一个整数L( 0≤L≤100,000 )，表示给定的表达式中除去横线外的运算符和括号的个数。

第 2 行为一个字符串包含L 个字符，其中只包含’（’、’）’、’+’、’*’这4 种字符，其中’ （’、’）’是左右括号，’+’、’*’分别表示前面定义的运算符“⊕”和“×”。这行字符按顺序 给出了给定表达式中除去变量外的运算符和括号。

## Output:

共1 行。包含一个整数，即所有的方案数。注意：这个数可能会很大，请输出方案数对10007 取模后的结果。

## Sample Input:

```
4  
+(*)
```

Copy

## Sample Output:

```
3
```

Copy

## Note:

每个测试点1s。





#  C 逛公园

## Description:

策策同学特别喜欢逛公园。公园可以看成一张 NN 个点 MM 条边构成的有向图，且没有自环和重边。其中 11 号点是公园的入口，NN 号点是公园的出口，每条边有一个非负权值，代表策策经过这条边所要花的时间。策策每天都会去逛公园，他总是从 11 号点进去，从 NN 号点出来。

策策喜欢新鲜的事物，他不希望有两天逛公园的路线完全一样，同时策策还是一个特别热爱学习的好孩子，他不希望每天在逛公园这件事上花费太多的时间。如果11号点到NN号点的最短路长为dd，那么策策只会喜欢长度不超过d+Kd+K的路线。策策同学想知道总共有多少条满足条件的路线，你能帮帮他吗？

为避免输出过大，答案对PP取模。如果有无穷多条合法的路线，请输出−1−1。

## Input:

第一行包含一个整数 TT, 代表数据组数。接下来TT组数据，对于每组数据：

第一行包含四个整数 NN, MM, KK, PP，每两个整数之间用一个空格隔开。

接下来MM行，每行三个整数aiai, bibi, cici，代表编号为aiai, bibi的点之间有一条权值为 cici的有向边，每两个整数之间用一个空格隔开。

## Output:

输出文件包含 TT 行，每行一个整数代表答案。

## Sample Input:

```
2
5 7 2 10
1 2 1
2 4 0
4 5 2
2 3 2
3 4 1
3 5 2
1 5 3
2 2 0 10
1 2 0
2 1 0
```

Copy

## Sample Output:

```
3
-1
```

Copy

## Note:

![说明](..\img\298834b0bf1bca389467cceeabaeb7a355e7baba)



#  E 飞扬的小鸟

## Description:

Flappy Bird 是一款风靡一时的休闲手机游戏。玩家需要不断控制点击手机屏幕的频率来调节小鸟的飞行高度，让小鸟顺利通过画面右方的管道缝隙。如果小鸟一不小心撞到了水管或者掉在地上的话，便宣告失败。

![图片](..\img\ab820ade16604d7b3ce8c4e0e64d6302f7ba0ac3)

为了简化问题，我们对游戏规则进行了简化和改编：

1. 游戏界面是一个长为 n，高为 m 的二维平面，其中有k 个管道（忽略管道的宽度）。
2. 小鸟始终在游戏界面内移动。小鸟从游戏界面最左边 任意整数高度位置出发，到达游戏界面最右边时，游戏完成。
3. 小鸟每个单位时间沿横坐标方向右移的距离为 1，竖直移动的距离由玩家控制。如果点击屏幕，小鸟就会上升一定高度 X，每个单位时间可以点击多次，效果叠加； 如果不点击屏幕，小鸟就会下降一定高度 Y。小鸟位于横坐标方向不同位置时，上 升的高度 X 和下降的高度 Y 可能互不相同。
4. 小鸟高度等于 0 或者小鸟碰到管道时，游戏失败。小鸟高度为 m 时，无法再上升。

现在，请你判断是否可以完成游戏。如果可以，输出最少点击屏幕数；否则，输出小鸟最多可以通过多少个管道缝隙。

## Input:

第 1 行有 3 个整数 n，m，k，分别表示游戏界面的长度，高度和水管的数量，每两个 整数之间用一个空格隔开；

接下来的 n 行，每行 2 个用一个空格隔开的整数 X 和 Y，依次表示在横坐标位置 0~n-1 上玩家点击屏幕后，小鸟在下一位置上升的高度 X，以及在这个位置上玩家不点击屏幕时， 小鸟在下一位置下降的高度 Y。

接下来 k 行，每行 3 个整数 P，L，H，每两个整数之间用一个空格隔开。每行表示一个管道，其中 P 表示管道的横坐标，L 表示此管道缝隙的下边沿高度为 L，H 表示管道缝隙上边沿的高度（输入数据保证 P 各不相同，但不保证按照大小顺序给出）。

## Output:

共两行。

第一行，包含一个整数，如果可以成功完成游戏，则输出 1，否则输出 0。 第二行，包含一个整数，如果第一行为 1，则输出成功完成游戏需要最少点击屏幕数，否则，输出小鸟最多可以通过多少个管道缝隙。

## Sample Input:

```
10 10 6
3 9
9 9
1 2
1 3
1 2
1 1
2 1
2 1
1 6
2 2
1 2 7
5 1 5
6 3 5
7 5 8
8 7 9
9 1 3
```

Copy

## Sample Output:

```
1
6
```

Copy

## Sample Input:

```
10 10 4
1 2
3 1
2 2
1 8
1 8
3 2
2 1
2 1
2 2
1 2
1 0 2
6 7 9
9 1 4
3 8 10
```

Copy

## Sample Output:

```
0
3
```

Copy

## Note:

对于 30%的数据：5≤n≤10，5≤m≤10，k=0，保证存在一组最优解使得同一单位时间最多点击屏幕 3 次；

对于 50%的数据：5≤n≤20，5≤m≤10，保证存在一组最优解使得同一单位时间最多点击屏幕 3 次；

对于 70%的数据：5≤n≤1000，5≤m≤100；

对于 100%的数据：5≤n≤10000，5≤m≤1000，0≤k<n，0<X<m，0<Y<m，0<P<n，0≤L<H ≤m，L+1<H。

如下图所示，蓝色直线表示小鸟的飞行轨迹，红色直线表示管道。

![图片](..\img\4565899bbede5f3f6ca80ecab2c94e35289ecec6)



# F 子串

## Description:

有两个仅包含小写英文字母的字符串 A 和 B。现在要从字符串 A 中取出 k 个**互不重叠**的非空子串，然后把这 k 个子串按照其在字符串 A 中出现的顺序依次连接起来得到一 个新的字符串，请问有多少种方案可以使得这个新串与字符串 B 相等？注意：子串取出的位置不同也认为是不同的方案。

## Input:

第一行是三个正整数 n，m，k，分别表示字符串 A 的长度，字符串 B 的长度，以及问 题描述中所提到的 k，每两个整数之间用一个空格隔开。第二行包含一个长度为 n 的字符串，表示字符串 A。 第三行包含一个长度为 m 的字符串，表示字符串 B。

## Output:

输出共一行，包含一个整数，表示所求方案数。**由于答案可能很大，所以这里要求输 出答案对 1,000,000,007 取模的结果。**

## Sample Input:

```
6 3 1
aabaab
aab
```

Copy

## Sample Output:

```
2
```

Copy

## Sample Input:

```
6 3 2
aabaab
aab
```

Copy

## Sample Output:

```
7
```

Copy

## Sample Input:

```
6 3 3
aabaab
aab
```

Copy

## Sample Output:

```
7
```

Copy

## Note:

对于第 1 组数据：1≤n≤500，1≤m≤50，k=1；
对于第 2 组至第 3 组数据：1≤n≤500，1≤m≤50，k=2；
对于第 4 组至第 5 组数据：1≤n≤500，1≤m≤50，k=m；
对于第 1 组至第 7 组数据：1≤n≤500，1≤m≤50，1≤k≤m；
对于第 1 组至第 9 组数据：1≤n≤1000，1≤m≤100，1≤k≤m；
对于所有 10 组数据：1≤n≤1000，1≤m≤200，1≤k≤m。

样例 1：**aab** aab / aab **aab**
样例 2：**a ab** aab / **a** aba **ab** / a **a** ba **ab** / aab **a ab**
**aa b** aab / **aa** baa **b** / aab **aa b**
样例 3：**a a b** aab / **a a** baa **b** / **a** ab **a** a **b** / **a** aba **a b**
a **a** b **a** a **b** / a **a** ba **a b** / aab **a a b**



# G 运输计划

## Description:

公元 2044 年，人类进入了宇宙纪元。L 国有 nn 个星球，还有 n−1n−1 条双向航道，每条航道建立在两个星球之间，这 n−1n−1 条 航道连通了 L 国的所有星球。

小 P 掌管一家物流公司，该公司有很多个运输计划，每个运输计划形如：有一艘物 流飞船需要从 uiui 号星球沿最快的宇航路径飞行到 vivi 号星球去。显然，飞船驶过一条航道是需要时间的，对于航道 jj，任意飞船驶过它所花费的时间为 tjtj，并且任意两艘飞船之间不会产生任何干扰。

为了鼓励科技创新，L 国国王同意小 PP 的物流公司参与 L 国的航道建设，即允许小 P 把某一条航道改造成虫洞，飞船驶过虫洞不消耗时间。

在虫洞的建设完成前小 P 的物流公司就预接了 mm 个运输计划。在虫洞建设完成后， 这 mm 个运输计划会同时开始，所有飞船一起出发。当这 mm 个运输计划都完成时，小 P 的 物流公司的阶段性工作就完成了。

如果小 P 可以自由选择将哪一条航道改造成虫洞，试求出小 P 的物流公司完成阶段性工作所需要的最短时间是多少？

## Input:

第一行包括两个正整数 nn、mm，表示 L 国中星球的数量及小 P 公司预接的运输计划的 数量，星球从 11 到 nn 编号。

接下来 n−1n−1 行描述航道的建设情况，其中第 ii 行包含三个整数 aiai, bibi 和 titi，表示第 ii 条双向航道修建在 aiai 与 bibi 两个星球之间，任意飞船驶过它所花费的时间为 titi。

接下来 mm 行描述运输计划的情况，其中第 jj 行包含两个正整数 ujuj 和 vjvj，表示第 jj 个 运输计划是从 ujuj 号星球飞往 vjvj 号星球。

## Output:

共 1 行，包含 1 个整数，表示小 P 的物流公司完成阶段性工作所需要的最短时间。

## Sample Input:

```
6 3
1 2 3
1 6 4
3 1 7
4 3 6
3 5 5
3 6
2 5
4 5
```

Copy

## Sample Output:

```
11
```

Copy

## Sample Input:

```
50 100
1 2 784
2 3 311
2 4 781
1 5 499
5 6 511
2 7 355
4 8 534
8 9 418
4 10 806
6 11 710
5 12 382
9 13 144
2 14 774
8 15 674
3 16 827
10 17 440
8 18 357
6 19 183
9 20 930
1 21 600
10 22 727
2 23 496
11 24 263
2 25 932
9 26 799
2 27 115
2 28 402
3 29 777
29 30 653
5 31 160
7 32 910
28 33 698
8 34 665
12 35 342
4 36 509
9 37 38
24 38 501
1 39 873
16 40 406
5 41 83
9 42 248
33 43 651
19 44 834
5 45 567
15 46 200
45 47 981
10 48 813
47 49 423
49 50 404
31 37
41 17
8 22
19 11
35 37
1 49
18 41
22 37
10 41
32 23
4 4
48 35
31 36
30 50
27 29
41 39
42 24
42 46
37 28
41 42
50 7
38 49
21 43
49 50
29 29
19 37
29 10
27 40
16 9
12 38
42 38
28 1
27 45
17 46
9 6
23 3
47 35
39 5
50 49
7 13
16 28
50 37
18 44
27 35
29 11
49 36
28 48
33 41
37 28
16 30
18 50
45 10
24 22
31 15
48 2
18 46
26 42
36 6
8 28
50 30
38 19
28 21
1 42
16 41
25 45
48 36
25 26
33 47
34 1
8 49
34 8
42 48
29 40
40 40
41 7
34 15
33 29
1 45
34 14
12 35
22 25
9 5
11 16
50 18
16 24
29 19
9 10
27 20
49 9
33 42
7 5
6 15
43 17
2 9
45 10
26 37
27 3
39 36
18 15
44 17
```

Copy

## Sample Output:

```
4645
```

Copy

## Note:

一共有20组数据。

其中n的取值依次为：100，100，100，2000，1000，2000，3000，1000，2000，3000，80000，100000，70000，80000，90000，100000，80000，90000，100000，300000。

其中m的取值依次为：1，100，100，1，1000，2000，3000，1000，2000，3000，1，1，70000，80000，90000，100000，80000，90000，100000，300000。

其中第2，5，6，7，13，14，15，16组数据满足：第 i 条航道连接 i 号星球与 i+1 号星球。

输入输出样例 1 说明。

　　将第 1 条航道改造成虫洞：则三个计划耗时分别为：11、12、11，故需要花费的时 间为 12。
　　将第 2 条航道改造成虫洞：则三个计划耗时分别为：7、15、11，故需要花费的时 间为 15。
　　将第 3 条航道改造成虫洞：则三个计划耗时分别为：4、8、11，故需要花费的时间 为 11。
　　将第 4 条航道改造成虫洞：则三个计划耗时分别为：11、15、5，故需要花费的时 间为 15。
　　将第 5 条航道改造成虫洞：则三个计划耗时分别为：11、10、6，故需要花费的时 间为 11。
　　故将第 3 条或第 5 条航道改造成虫洞均可使得完成阶段性工作的耗时最短，需要花 费的时间为 11。